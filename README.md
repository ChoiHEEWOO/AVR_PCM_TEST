# 품평회 멘토링
ATMEGA128 PCM TEST


## AVR을 이용한 PCM 오르골



### TICK타이머 구현

타이밍을 중요하게 고려해주어야 하는 시스템의 경우 tick 타이머가 큰 도움이 된다. 





### GPIO 입력부 구현


### 문제 발생 및 고려 사항 등등

 - 인터럽트 발생 빈도가 너무 빠르다면 다른 시스템에 영향을 준다. 예를 들어, TIM0 비교매치 인터럽트 주기가 50kHz인데, 이것 말고도 다른 인터럽트(A인터럽트라고 가정)도 사용을 한다고 할 때,
 A 인터럽트는 10ms마다 발생한다고 칠 때, TIM0 비교매치 인터럽트가 A 인터럽트가 발생하는 순간순간마다 뺏어가는 상황들이 발생하여 A 인터럽트 동작에 부정적인 영향을 끼친다. 
 
 
 - 뿐만 아니라, main루프에도 좋지 않은 영향을 미친다. main 루프에 딜레이가 들어가는 상황을 만드는 것은 가급적 피하는 것이 좋다. 만일 인터럽트가 너무 자주 발생한다면 이는 마치 main루프에 딜레이를 거는것과 비슷한 결과를 낳는다. 

 - 해당 문제에 대한 결론은 다음과 같다. 
  - 시스템 클럭이 16MHz인 것을 고려할 때, 32KHz속도로 발생하는 인터럽트를 만들어주는 것은 애초에 설계부터 잘못되었다. 
  
  - 해당 시스템에서 32KHz로 만들어줄 수 밖에 없는 상황이라면, ISR 루틴에 코드를 최대한 간결하게 작성해주어야 한다. 
  
  - 1ms짜리 tick Timer는 main문에서 만들어주도록 한다. 
  
  - 다음 부턴 비슷한 상황이 생긴다면, 인터럽트 발생 속도를 낮추던지, 시스템 클럭이 월등히 높은 MCU를 선정하는 판단이 필요하다. 
  
  
